Attribute VB_Name = "eq_nn_case"
Function nn_x_b3_case(xx1, xx2, xx3, xx4, xx5, xx6, xx7, hidden2_, hidden3_, hidden4_, hidden5_, case_)
    If case_ = 2 Then
        x1 = fminmax(xx1, 0.248668898615326, 0.59769387755102): x2 = fminmax(xx2, 0, 0): x3 = fminmax(xx3, 0.01, 0.986838420610473): x4 = fminmax(xx4, 1, 1): x5 = fminmax(xx5, 1.31615793895268E-02, 0.99): x6 = fminmax(xx6, 0.47244094488189, 1.5): x7 = fminmax(xx7, 0, 0):
         
 
        'case= 2
        'input = x1 x3 x6
        'NN-hidden nodes = 1
        'rmse_training =  0.1485837 'squared=0.022
        'rmse_train_val =  0.2007525
        'rmse_test =  0.2276021
        'formula:
        z = 1.81760920450747
        z = z + -1.58103467061278 * 1 / (1 + Exp(-(1.82869307206915 + -0.863095128180204 * x1 + -0.209784732362605 * x3 + -0.558414342131462 * x6)))

        z = fminmax(z, 0.441929789124045, 1.18845467109234):
    ElseIf case_ = 3 Then
        x1 = fminmax(xx1, 0.116617219019459, 0.6851488): x2 = fminmax(xx2, 0.177777777777778, 0.85): x3 = fminmax(xx3, 0, 0.88): x4 = fminmax(xx4, 0.01, 0.954166666666667): x5 = fminmax(xx5, 0.01, 0.6): x6 = fminmax(xx6, 0.2, 1.5): x7 = fminmax(xx7, 0, 1.83333333333333):

        'case= 3
        'input = x1 x2 x3 x4 x5 x6 x7
        'NN-hidden nodes = 3
        'rmse_training =  0.1093109
        'rmse_train_val =  0.08743945
        'rmse_test =  0.1289643
        'formula:
        z = -0.665958811365845
        z = z + 1.00224574310889 * 1 / (1 + Exp(-(-7.27943087987807 + 1.96369807874529 * x1 + 27.7789203794183 * x2 + 0.418774299612704 * x3 + 3.36961234667794 * x4 + 4.03820025640779 * x5 + -2.45315589315258 * x6 + 0.208702488880066 * x7)))
        z = z + 1.14938814064808 * 1 / (1 + Exp(-(-1.94902339295288E-02 + 0.584743325487877 * x1 + 2.47276211461011 * x2 + -1.52929824013203 * x3 + 8.60010189134392E-02 * x4 + 5.10699610841874 * x5 + -4.49877791989082 * x6 + -1.18511080989582 * x7)))
        z = z + 1.08078075976323 * 1 / (1 + Exp(-(0.744919567796539 + 1.63191039595755 * x1 + -10.113039801214 * x2 + -1.61266325146287 * x3 + -0.407788602608442 * x4 + -3.1275480472445 * x5 + 1.73696113987798 * x6 + 1.93312351577115 * x7)))
        
        
       z = fminmax(z, 0.350480853596402, 1.20687316557003):
    ElseIf case_ = 4 Then
        x1 = fminmax(xx1, 0.116617219019459, 0.6851488): x2 = fminmax(xx2, 0.177777777777778, 1): x3 = fminmax(xx3, -1.42857142857143, -8.6887835702996E-04): x4 = fminmax(xx4, 0, 1.01): x5 = fminmax(xx5, 0.1, 1.59055118110236): x6 = fminmax(xx6, 0.2, 4.28571428571429): x7 = fminmax(xx7, 0, 1.83333333333333): z = fminmax(z, 2.10453289138556E-03, 1.18043667018193):
        
        'case= 4
        'input = x1 x2 x3 x4 x5 x6 x7
        'NN-hidden nodes = 2
        'rmse_training =  0.2002133
        'rmse_train_val =  0.2359561
        'rmse_test =  0.287308
        'formula:
        z = -0.517082830777056
        z = z + 2.16788500039099 * 1 / (1 + Exp(-(2.85696656082528 + 9.12366649321903 * x1 + -2.23141386538419 * x2 + -5.96931173010888 * x3 + -4.14569682031816 * x4 + -2.68101609329839 * x5 + -8.47509197804483 * x6 + -2.29578333192217 * x7)))
        z = z + 1.27978204382179 * 1 / (1 + Exp(-(-4.63162808029434 + -10.4441304568026 * x1 + 7.2725802604241 * x2 + 1.37134107739021 * x3 + 32.2760864440036 * x4 + -6.99070152054645E-02 * x5 + 5.6079115356593 * x6 + 1.45102656744885 * x7)))
      

        z = fminmax(z, 3.78668073195147E-03, 1.74722420826812):
    ElseIf case_ = 5 Then
        x1 = fminmax(xx1, 0, 0.6851488): x2 = fminmax(xx2, 0.177777777777778, 0.85): x3 = fminmax(xx3, -2.04, -0.1): x4 = fminmax(xx4, -1.5, -7.14285714285714E-03): x5 = fminmax(xx5, 8.33333333333334E-03, 0.769230769230769): x6 = fminmax(xx6, 0.2, 2.30769230769231): x7 = fminmax(xx7, 0, 1.83333333333333):


        'case= 5
        'input = x2 x4 x5 x6 x7
        'NN-hidden nodes = 2
        'rmse_training =  0.1331509
        'rmse_train_val =  0.181963
        'rmse_test =  0.1789568
        'formula:
        z = 4.99289018994819E-02
        z = z + 4.33271617983208 * 1 / (1 + Exp(-(-4.97899288510097 + -24.2402520293778 * x2 + 0.909733146125572 * x4 + 1.13419507306403 * x5 + 5.29630052310352 * x6 + 2.88861095944607 * x7)))
        z = z + 0.967596770068671 * 1 / (1 + Exp(-(0.30064264716185 + 4.37696975725064 * x2 + -2.62186644409109 * x4 + -4.0614432070854 * x5 + -2.06260881445365 * x6 + -0.24588465011735 * x7)))
        

        z = fminmax(z, 8.69521112019744E-03, 1.17995552612205):
    End If
   
    nn_x_b3_case = z
End Function
